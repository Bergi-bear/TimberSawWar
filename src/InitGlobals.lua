---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Bergi.
--- DateTime: 10.01.2020 22:05
---
do
	local InitGlobalsOrigin = InitGlobals -- записываем InitGlobals в переменную
	function InitGlobals()
		-- заменяем оригинальную InitGlobals своей
		InitGlobalsOrigin() -- вызываем оригинальную InitGlobals из переменной
		--добавляем в список функции для инициализации
		InitSpellTrigger()
		InitMouseMoveTrigger()
		--print("globalinit")
		InitGameCore()
		InitDamage()
		InitTimers()
		InitDestructablesActions()
		InitUnitDeath()
		InitTalants()
		--InitShop()
	end

end
HERO                  = {} -- таблица героев
HERO_ID               = FourCC('H000') -- ид единственного героя
ReactiveArmorCooldown = 10 -- время снятия заряда пассивки
ReactiveArmorUnit     = FourCC('n000')
HEROSimple            = {} -- упрощённая таблица
Quest                 = {} -- таблица квестов


function InitGameCore()
	for i = 0, bj_MAX_PLAYER_SLOTS - 1 do
		local player = Player(i)
		if i==0 then -- GetPlayerController(player) == MAP_CONTROL_USER and GetPlayerSlotState(player) == PLAYER_SLOT_STATE_PLAYING then
			--print("3")
			--FIXME сделать нормальное появление героя
			local hero = CreateUnit(player, HERO_ID, -7042, 6910, 0)
			UnitAddAbility(hero, FourCC('Asud')) -- Продажа юнита
			local WaitReturner = CreateUnit(player, FourCC('e001'), -0, 0, 0)
			HEROSimple[GetPlayerId(GetOwningPlayer(hero))+1]=hero
			-- ReactiveArmor
			--AddUnitToStock(hero, ReactiveArmorUnit, 0, 0)
			UnitAddAbility(hero,FourCC('A003'))--возврат пилы
			BlzUnitHideAbility(hero,FourCC('A003') ,true)-- и скрыть
			--BlzSetUnitWeaponRealField(caster,UNIT_WEAPON_RF_ATTACK_RANGE,0,1000)

			HERO[GetHandleId(hero)] = {--стартовые параметры героя
				unit                 = hero, -- ссылка на юнита
				ReactiveArmorChargesTime = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, -- время снятия заряда, количество зарядов определяется количество элементов
				ReactiveArmorLimit   = true, -- ограниченное количество зарядов
				WaitReturnerUnit = WaitReturner,
				ChakrumUnit=nil,
				IsReturned=false,
				FirstDamage=false,
				KillCount=0,
				TreeCount=0
			}
			QuestRegistrator(hero)

		end--цикл всех игроков
	end
	--инициализация квестов
	local questmax=20
	for i = 1, questmax do
		--print("добавление квестов")
		Quest[i]={
			isend=false,
			questendunit=nil,
			hero=nil,
			isactive=false
		}
	end

end



